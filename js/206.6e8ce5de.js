"use strict";(self["webpackChunkweek6_homework"]=self["webpackChunkweek6_homework"]||[]).push([[206],{1207:function(e,l,t){function a(e){return{all:e=e||new Map,on:function(l,t){var a=e.get(l);a?a.push(t):e.set(l,[t])},off:function(l,t){var a=e.get(l);a&&(t?a.splice(a.indexOf(t)>>>0,1):e.set(l,[]))},emit:function(l,t){var a=e.get(l);a&&a.slice().map((function(e){e(t)})),(a=e.get("*"))&&a.slice().map((function(e){e(l,t)}))}}}t.d(l,{Z:function(){return o}});const s=a();var o=s},7206:function(e,l,t){t.r(l),t.d(l,{default:function(){return z}});var a=t(1831),s=t(6923),o=t(2847);const r=(0,a._)("h1",{class:"text-center"}," Cart ",-1),n={class:"container w300"},c={class:"row justify-content-center"},i={class:"table align-middle text-center"},m=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{class:"col-1"}),(0,a._)("th",{class:"col-3"}," 品名 "),(0,a._)("th",{class:"col-2"}," 數量 "),(0,a._)("th",{class:"col-2"}," 單價 ")])],-1),d=["onClick"],u={class:"text-end"},h=(0,a._)("th",{colspan:"3"}," 總計 ",-1),p={class:"home"},f={class:"mb-3"},_=(0,a._)("label",{for:"email",class:"form-label"},"Email",-1),b={class:"mb-3"},v=(0,a._)("label",{for:"email",class:"form-label"},"收件人姓名",-1),g={class:"mb-3"},w=(0,a._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),C={class:"mb-3"},k=(0,a._)("label",{for:"email",class:"form-label"},"收件人地址",-1),y={class:"mb-3"},x=(0,a._)("label",{for:"message",class:"form-label"},"留言",-1),V=(0,a._)("div",{class:"text-end"},[(0,a._)("button",{class:"btn btn-primary",type:"submit"}," 送出訂單 ")],-1);function W(e,l,t,W,$,U){const Z=(0,a.up)("Field"),q=(0,a.up)("error-message"),z=(0,a.up)("Form");return(0,a.wg)(),(0,a.iD)(a.HY,null,[r,(0,a._)("div",n,[(0,a._)("div",c,[(0,a._)("table",i,[m,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)($.carts.carts,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("th",null,[(0,a._)("button",{class:"btn btn-sm btn-outline-danger",onClick:l=>U.removeCart(e.id)}," 移除購物車 ",8,d)]),(0,a._)("th",null,(0,s.zw)(e.product.title),1),(0,a._)("th",null,(0,s.zw)(e.qty)+" / 個",1),(0,a._)("th",null,(0,s.zw)(e.total),1)])))),128))]),(0,a._)("tfoot",null,[(0,a._)("tr",u,[h,(0,a._)("th",null,(0,s.zw)($.carts.total),1)])])])]),(0,a._)("div",p,[(0,a.Wm)(z,{ref:"form",onSubmit:U.onSubmit},{default:(0,a.w5)((({errors:e})=>[(0,a._)("div",f,[_,(0,a.Wm)(Z,{id:"email",modelValue:$.order.user.email,"onUpdate:modelValue":l[0]||(l[0]=e=>$.order.user.email=e),name:"email",type:"email",class:(0,s.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"email|required"},null,8,["modelValue","class"]),(0,a.Wm)(q,{name:"email",class:"invalid-feedback"})]),(0,a._)("div",b,[v,(0,a.Wm)(Z,{id:"name",modelValue:$.order.user.name,"onUpdate:modelValue":l[1]||(l[1]=e=>$.order.user.name=e),name:"姓名",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入 姓名",rules:"required"},null,8,["modelValue","class"]),(0,a.Wm)(q,{name:"姓名",class:"invalid-feedback"})]),(0,a._)("div",g,[w,(0,a.Wm)(Z,{id:"name",modelValue:$.order.user.tel,"onUpdate:modelValue":l[2]||(l[2]=e=>$.order.user.tel=e),name:"電話",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["電話"]}]),placeholder:"請輸入 收件人電話",rules:U.isPhone},null,8,["modelValue","class","rules"]),(0,a.Wm)(q,{name:"電話",class:"invalid-feedback"})]),(0,a._)("div",C,[k,(0,a.Wm)(Z,{id:"name",modelValue:$.order.user.address,"onUpdate:modelValue":l[3]||(l[3]=e=>$.order.user.address=e),name:"地址",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入 地址",rules:"required"},null,8,["modelValue","class"]),(0,a.Wm)(q,{name:"地址",class:"invalid-feedback"})]),(0,a._)("div",y,[x,(0,a.wy)((0,a._)("textarea",{id:"message","onUpdate:modelValue":l[4]||(l[4]=e=>$.order.message=e),name:"",class:"form-control",cols:"30",rows:"10"},null,512),[[o.nr,$.order.message]])]),V])),_:1},8,["onSubmit"])])])],64)}var $=t(1207),U={data(){return{carts:{},order:{user:{email:"",name:"",tel:"",address:""},message:""}}},mounted(){this.getCart()},methods:{getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/necy6553/cart").then((e=>{this.carts=e.data.data})).catch((e=>{console.log(e)}))},removeCart(e){console.log(e),this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/necy6553/cart/${e}`).then((e=>{this.getCart(),$.Z.emit("get-cart")})).catch((e=>{console.log(e)}))},removeallCart(){this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/necy6553/carts").then((e=>{this.getCart(),$.Z.emit("get-cart")})).catch((e=>{console.log(e)}))},onSubmit(){const e=this.order;this.$http.post("https://vue3-course-api.hexschool.io/v2/api/necy6553/order",{data:e}).then((e=>{this.$refs.form.resetForm(),$.Z.emit("get-cart"),this.getCart()})).catch((e=>{console.log(e)}))},isPhone(e){const l=/^(09)[0-9]{8}$/;return!!l.test(e)||"需要正確的電話號碼"}}},Z=t(497);const q=(0,Z.Z)(U,[["render",W]]);var z=q}}]);
//# sourceMappingURL=206.6e8ce5de.js.map